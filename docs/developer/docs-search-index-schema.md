# Docs Search Index Schema

Story: `02.02-implement-docs-search-index-output`

## Artifact

- Build output path: `dist/docs/search-index.json`
- Route path in app/runtime: `/docs/search-index.json`
- Generation mode: static during Astro build (`prerender = true`)

## Schema

```json
{
  "schemaVersion": 1,
  "items": [
    {
      "id": "getting-started",
      "title": "Getting Started",
      "description": "How to use Team Orchestrator.",
      "path": "/docs/getting-started/",
      "section": "General",
      "sectionOrder": 1,
      "order": 1,
      "headings": [
        {
          "depth": 2,
          "slug": "first-mission",
          "text": "First Mission"
        }
      ]
    }
  ]
}
```

## Field Contract

- `schemaVersion`: integer schema version for downstream compatibility checks.
- `items`: ordered list of docs entries.
- `id`: docs slug (`CollectionEntry.slug`), stable logical key per page.
- `title`: docs page title.
- `description`: docs page summary/description.
- `path`: canonical docs route path with trailing slash.
- `section`: docs section label from frontmatter.
- `sectionOrder`: section ordering value from frontmatter.
- `order`: in-section ordering value from frontmatter.
- `headings`: heading metadata extracted from rendered markdown.
- `headings[].depth`: heading level (currently filtered to `2..3`).
- `headings[].slug`: anchor slug generated by markdown rendering.
- `headings[].text`: normalized heading text.

## Ordering & Determinism

- Items follow existing docs ordering (`sectionOrder`, then `section`, then `order`).
- Heading extraction order matches markdown render order.
- Output excludes timestamps and environment-specific metadata to keep artifacts deterministic across builds.

## Downstream Consumption Guidance

- Search UI should load `/docs/search-index.json` once, cache in memory, and perform client-side filtering/ranking.
- Recommended index text source per page:
  - high weight: `title`
  - medium weight: `headings[].text`
  - medium/low weight: `description`
- Route navigation should use `path`; deep linking can append `#${headings[].slug}` where relevant.
- Consumers should gate parsing on `schemaVersion === 1` and fail closed for unknown versions.
